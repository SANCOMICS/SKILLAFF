import{r as S,j as r}from"./index-Bhhhx7h4.js";import{u as A}from"./useUserContext-CjczNUYd.js";import{A as c,T as E}from"./index-D9_lrgu6.js";import{I as O}from"./index-CH34cjkL.js";import{C as L}from"./CoursePaymentModal-D1Ms6t_1.js";import{u as U,a as b}from"./index-CeUTncnb.js";import{S as k}from"./index-_rPoQdzz.js";import{B as p}from"./button-DgkAoqE2.js";import{L as o}from"./index-dGebq1Ms.js";import{C as u}from"./index-ydtyDG1o.js";import{s as i}from"./index-DaEJ5rVL.js";import{P as x}from"./index-ufwEpZVH.js";import"./index-Bs36QOeU.js";import"./index-IivWOIOz.js";import"./pickAttrs-r0RFaJBP.js";import"./SearchOutlined-CdaQ9A1C.js";import"./collapse-BbEVqHco.js";import"./row-DHszOpHb.js";import"./responsiveObserver-Cz69L87y.js";import"./ExclamationCircleFilled-CiuxUjGk.js";import"./index-DsxaOx6h.js";import"./CloseOutlined-Dxm4jkL9.js";import"./useClosable-CCDYGg12.js";import"./Dropdown-DVbf8yOU.js";import"./fade-2t19LHl3.js";import"./index-Bjxa92qe.js";import"./index-DIL_-TYb.js";import"./Pagination-CBJzwpBi.js";import"./LeftOutlined-R_ycQdco.js";import"./useBreakpoint-D4cuiZ4X.js";import"./EllipsisOutlined-D3hTA01Z.js";import"./index-Hz7ZMWx3.js";import"./index-CeoCv33H.js";const{Title:h,Text:a}=E;function xe(){var d;const n=U(),{isLoggedIn:g,user:f}=A(),{courseId:j}=b(),[y,m]=S.useState(!1),{data:e,isLoading:v}=c.course.findUnique.useQuery({where:{id:j},include:{sections:{include:{videos:!0}}}}),{mutateAsync:C}=c.userCourse.create.useMutation(),I=async t=>{if(!g){i.warning("Please login to join courses"),n("/login");return}if(!t.price){i.warning("Course price not available");return}m(!0)},P=async()=>{try{await C({data:{courseId:e.id,userId:f.id}}),i.success("Successfully enrolled in course"),n(`/courses/${e.id}`)}catch(t){t.code==="CONFLICT"?i.error("You are already enrolled in this course"):i.error("Failed to enroll in course")}},w=t=>{i.error(t)},N=()=>{n("/upgrade")};return v?r.jsx(x,{layout:"full-width",children:r.jsx("div",{style:{textAlign:"center",padding:"50px"},children:r.jsx(k,{size:"large"})})}):r.jsxs(x,{layout:"full-width",children:[r.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:r.jsx(O.Img,{src:e==null?void 0:e.previewUrl,srcOnError:"/images/course-fallback.jpg",isPretty:!0,styleWrapper:{position:"relative",maxWidth:"100%",height:"auto",aspectRatio:"16/9"},styleImg:{objectFit:"cover",objectPosition:"center",width:"100%",height:"100%"}})}),r.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"20px"},children:[r.jsx(h,{level:2,children:e==null?void 0:e.title}),r.jsx(a,{children:e==null?void 0:e.description}),r.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[r.jsxs(a,{strong:!0,children:["XAF ",e==null?void 0:e.price]}),r.jsx(p,{type:"primary",onClick:()=>I(e),children:"GET NOW"})]}),r.jsx(o,{className:"mt-8",dataSource:(d=e==null?void 0:e.sections)==null?void 0:d.sort((t,s)=>t.order-s.order),renderItem:t=>{var s;return r.jsx(o.Item,{children:r.jsx(u,{title:t.title,className:"w-full",children:r.jsx(o,{dataSource:(s=t.videos)==null?void 0:s.sort((l,T)=>l.order-T.order),renderItem:l=>r.jsx(o.Item,{children:r.jsx(a,{children:l.title})})})})})}}),r.jsxs(u,{style:{marginTop:"24px",textAlign:"center",background:"#f0f7ff"},children:[r.jsxs(h,{level:4,children:[r.jsx("i",{className:"las la-crown"})," Unlock All Premium Content"]}),r.jsx(a,{children:"Get unlimited access to all our premium courses and exclusive content."}),r.jsx("div",{style:{marginTop:"16px"},children:r.jsx(p,{type:"primary",size:"large",onClick:N,children:"Upgrade Now"})})]}),r.jsx(L,{isOpen:y,onClose:()=>m(!1),courseId:e==null?void 0:e.id,courseTitle:e==null?void 0:e.title,amount:e==null?void 0:e.price,onSuccess:P,onError:w})]})]})}export{xe as default};
